{% extends 'base.html' %}

{% block content %}

<div style="max-width: 600px; margin: auto; padding: 2rem; border: 1px solid #ddd; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
    <div style="text-align: center;">
        <!-- –ê–≤–∞—Ç–∞—Ä–∫–∞ -->
        {% if profile_user.avatar %}
            <img src="{{ profile_user.avatar.url }}" alt="avatar" style="width: 120px; height: 120px; border-radius: 50%; object-fit: cover; margin-bottom: 1rem;">
        {% endif %}

        <h2 style="margin-bottom: 0.5rem;">{{ profile_user.first_name }} {{ profile_user.last_name }}</h2>
        <p style="color: #555;">{{ profile_user.email }}</p>
        <p style="color: #555;">–¢–µ–ª–µ—Ñ–æ–Ω: {{ profile_user.phone }}</p>

        <!-- –û —Å–µ–±–µ -->
        {% if profile_user.bio %}
            <div style="margin-top: 1rem; padding: 1rem; background-color: #f9f9f9; border-radius: 8px; color: #333;">
                <strong>–û —Å–µ–±–µ:</strong>
                <p style="margin-top: 0.5rem;">{{ profile_user.bio }}</p>
            </div>
        {% endif %}

        <!-- –ö–Ω–æ–ø–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
        {% if user.is_authenticated and user == profile_user %}
            <div style="margin-top: 1rem;">
                <a href="{% url 'user:edit_profile' %}">
                    <button style="background-color: #555; color: white; border: none; padding: 0.5rem 1.5rem; border-radius: 5px; cursor: pointer;">
                        ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
                    </button>
                </a>
            </div>
        {% endif %}
    </div>

    <div style="display: flex; justify-content: space-around; margin-top: 1rem;">
        <div>
            <strong>{{ followers_count }}</strong>
            <p style="margin: 0; font-size: 0.9rem; color: #666;">–ü–æ–¥–ø–∏—Å—á–∏–∫–∏</p>
        </div>
        <div>
            <strong>{{ following_count }}</strong>
            <p style="margin: 0; font-size: 0.9rem; color: #666;">–ü–æ–¥–ø–∏—Å–∫–∏</p>
        </div>
    </div>

    {% if user.is_authenticated and user != profile_user %}
    <div style="margin-top: 2rem; text-align: center;">
        <form method="post" action="{% url 'user:toggle_follow' profile_user.id %}" style="display: inline;">
            {% csrf_token %}
            <button type="submit" style="background-color: {% if is_following %}#f44336{% else %}#4CAF50{% endif %}; color: white; border: none; padding: 0.5rem 1.5rem; border-radius: 5px; cursor: pointer;">
                {% if is_following %}–û—Ç–ø–∏—Å–∞—Ç—å—Å—è{% else %}–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è{% endif %}
            </button>
        </form>

        <a href="{% url 'chat:chat_view' other_user_id=profile_user.id %}" style="margin-left: 1rem;">
            <button style="background-color: #2196F3; color: white; border: none; padding: 0.5rem 1.5rem; border-radius: 5px; cursor: pointer;">
                –ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
            </button>
        </a>
    </div>
    {% endif %}
</div>

<hr style="margin: 2rem 0;">
<h3 style="text-align: center;">–ü–æ—Å—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>

{% if posts %}
<div style="display: flex; flex-direction: column; gap: 1.5rem; margin-top: 1rem; max-width: 600px; margin-left: auto; margin-right: auto;">
    {% for post in posts %}
    <a href="{% url 'news:details' post.id %}" style="text-decoration: none; color: inherit;">
        <div style="border: 1px solid #ccc; border-radius: 8px; padding: 1rem;">
            <h4>{{ post.title }}</h4>
            <p>{{ post.content|truncatewords:25 }}</p>
            <small style="color: #888;">–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ: {{ post.publication_date }}</small>
    
            <div style="margin-top: 0.5rem; font-size: 0.9rem; color: #555;">
                ‚ù§Ô∏è {{ post.likes.count }} –ª–∞–π–∫–æ–≤ | üí¨ {{ post.comments.count }} –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
            </div>
    
            {% if post.attachments.all %}
            <div style="margin-top: 1rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                {% for attachment in post.attachments.all %}
                <img src="{{ attachment.image.url }}" alt="{{ attachment.name }}" style="max-width: 100px; max-height: 100px; border-radius: 4px;">
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </a>
    {% endfor %}
</div>
{% else %}
<p style="text-align: center; color: #666;">–≠—Ç–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–ª.</p>
{% endif %}

{% endblock %}
