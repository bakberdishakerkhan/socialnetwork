{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container" style="max-width: 600px; margin: 40px auto; background: #fff; border-radius: 12px; box-shadow: 0 4px 16px rgba(0,0,0,0.08); overflow: hidden; font-family: Arial, sans-serif;">

    <!-- –ö–∞—Ä—É—Å–µ–ª—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π -->
    <div style="display: flex; overflow-x: auto; scroll-snap-type: x mandatory;">
        {% for image in images %}
            <img src="{{ image.image.url }}" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å—Ç–∞" style="width: 100%; height: auto; scroll-snap-align: start;">
        {% endfor %}
    </div>

    <!-- –¢–µ–∫—Å—Ç–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div style="padding: 24px;">
        <a href="{% url 'user:profile' post.author.id %}" style="font-weight: bold; font-size: 16px; color: #0077cc; text-decoration: none;">
            {{ post.author.first_name }} {{ post.author.last_name }}
        </a>
        <h3 style="margin-top: 10px; font-size: 22px; color: #212529;">{{ post.title }}</h3>
        <p style="color: #333; font-size: 15px; line-height: 1.6;">{{ post.content }}</p>
        <p style="font-size: 13px; color: #888; margin-top: 10px;">–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ: {{ post.publication_date }}</p>
    </div>

    <!-- –õ–∞–π–∫ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ -->
    <div style="padding: 0 24px 24px 24px;">
        <!-- –õ–∞–π–∫ -->
        {% if request.user.is_authenticated %}
            <form method="post" action="{% url 'news:like-post' post.id %}">
                {% csrf_token %}
                <button type="submit" style="background: none; border: none; color: #0077cc; font-weight: bold; cursor: pointer;">
                    {% if is_liked %}
                        üëé –£–±—Ä–∞—Ç—å –ª–∞–π–∫
                    {% else %}
                        üëç –õ–∞–π–∫
                    {% endif %}
                </button>
                <span style="margin-left: 10px; color: #555;">{{ post.likes.count }} –ª–∞–π–∫–æ–≤</span>
            </form>
        {% else %}
            <p><a href="{% url 'user:login' %}">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã –ø–æ—Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫.</p>
        {% endif %}
    </div>

    <!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ -->
    <div style="padding: 0 24px 24px 24px;">
        <h4 style="margin-bottom: 10px;">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ({{ post.comments.count }})</h4>
        <ul style="list-style: none; padding: 0; max-height: 200px; overflow-y: auto;">
            {% for comment in post.comments.all %}
                <li style="margin-bottom: 10px; border-bottom: 1px solid #eee; padding-bottom: 6px;">
                    <strong>{{ comment.user.first_name }}</strong>: {{ comment.text }}<br>
                    <small style="color: #888;">{{ comment.created_at }}</small>
                </li>
            {% empty %}
                <li>–ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.</li>
            {% endfor %}
        </ul>

        {% if request.user.is_authenticated %}
        <form method="post" action="{% url 'news:add-comment' post.id %}" style="margin-top: 12px;">
            {% csrf_token %}
            <textarea name="comment" rows="3" style="width: 100%; border: 1px solid #ccc; border-radius: 6px; padding: 8px;" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."></textarea>
            <button type="submit" style="margin-top: 8px; background-color: #4CAF50; color: white; border: none; padding: 6px 12px; border-radius: 5px;">–î–æ–±–∞–≤–∏—Ç—å</button>
        </form>
        {% else %}
            <p><a href="{% url 'user:login' %}">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å.</p>
        {% endif %}
    </div>

    <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–º -->
    {% if request.user.is_authenticated and request.user == post.author or request.user.is_superuser %}
    <div style="display: flex; justify-content: space-between; padding: 16px 24px; border-top: 1px solid #eee; background-color: #f9f9f9;">
        <a href="{% url 'news:edit-post' pid=post.pk %}" style="color: #0077cc; text-decoration: none;">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
        <a href="{% url 'news:delete-post' pid=post.pk %}" style="color: #dc3545; text-decoration: none;">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</a>
    </div>
    {% endif %}
</div>
{% endblock %}
